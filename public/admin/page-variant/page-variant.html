<link rel="import" href="../../components/api-model/api-model.html">
<link rel="import" href="../layout-admin/layout-admin.html">
<link rel="import" href="part-variant-create.html">
<link rel="import" href="part-variant-delete.html">
<link rel="import" href="part-variant-pricing.html">
<link rel="import" href="part-variant-inventory.html">
<link rel="import" href="part-variant-shipping.html">
<link rel="import" href="part-variant-available.html">
<link rel="import" href="part-variant-header.html">
<dom-module id="page-variant">
  <template>

    <api-model-update id="update" collection="product_variants"
      data="{{variant}}" model-id="{{variant.id}}">
    </api-model-update>

    <api-model-delete id="delete_model" collection="product_variants"
      model-id="{{variant.id}}" on-response="on_response_delete">
    </api-model-delete>

    <layout-admin>
      <h1>Variant</h1>
      <part-variant-header product="{{product}}"variant="{{variant}}"></part-variant-header>
      <part-variant-create on-try-save="on_try_save"></part-variant-create>
      <part-variant-delete on-try-delete="on_try_delete"></part-variant-delete>
      <part-variant-available variant="{{variant}}"></part-variant-available>
      <part-variant-pricing variant="{{variant}}"></part-variant-pricing>
      <part-variant-inventory variant="{{variant}}"></part-variant-inventory>
      <part-variant-shipping variant="{{variant}}"></part-variant-shipping>
    </layout-admin>

  </template>
</dom-module>
<script>
  Polymer({

    is: 'page-variant',

    properties: {
      product: {
        type: Object,
        value: function () { return {}; }
      },
      variant: {
        type: Object,
        value: function () { return {}; }
      }
    },

    attached: function ()Â {
      this.variant = this.route.data.variant;
      this.product = this.variant.product;
    },

    on_try_save: function (event) {
      event.stopPropagation();
      this.$.update.send();
    },

    on_response_put_variant: function (event, details) {
      event.stopPropagation();
    },

    on_try_delete: function (event) {
      event.stopPropagation();
      this.$.delete_model.send();
    },

    on_response_delete: function (event) {
      event.stopPropagation();
      page('/admin/products/' + this.product.id + '/variants');
    },

    on_error: function (event) {
      event.stopPropagation();
      console.log(event);
    }

  });
</script>