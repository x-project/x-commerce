<link rel="import" href="part-order-item.html">
<dom-module id="part-order-items">
	<template>
		<style>
			:host {
				display: block;
			}
		</style>

		<h2>Order items</h2>

    <iron-ajax id="ajax_get_order_items" method="GET" on-error="on_error"
      last-response="{{order_items}}"></iron-ajax>

    <iron-ajax id="ajax_delete" method="DELETE" on-error="on_error"></iron-ajax>

		<div class="items">
			<template is="dom-repeat" items="{{order_items}}" as="order_item">
        <part-order-item data="{{order_item}}"></part-order-item>
			</template>
		</div>

	</template>
</dom-module>
<script>
	Polymer({

		is: 'part-order-items',

		properties: {
			order_items: {
				type: Array,
				value: function () { return []; }
			}
		},

    attached: function () {
      this.update_order_items();
    },

    update_order_items: function () {
      this.$.ajax_get_order_items.url = '/api/orders/'+ this.order.id + '/order_items?filter=%7B%22include%22%3A%5B%22product%22%2C%22product_variant%22%5D%7D'
      this.$.ajax_get_order_items.generateRequest();
    },

    on_error: function (event) {
      event.stopPropagation();
      console.log(event);
    }

	});
</script>