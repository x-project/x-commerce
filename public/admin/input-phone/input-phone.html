<link rel="import" href="../../styles/style-form/style-form.html">
<link rel="import" href="../../styles/style-label/style-label.html">

<dom-module id="input-phone">
  <template>
    <style include="style-form"></style>
    <style include="style-label"></style>
    <style>
      input {
        box-sizing: border-box;
      }
      input.prefix {
        @apply(--input-phone-prefix);
      }
      input.number {
        @apply(--input-phone-number);
      }
    </style>

    <div class="field">
      <label class="label">[[label]]</label>
      <input class="prefix" type="number" is="iron-input"
        bind-value="{{prefix}}">
      <input class="number" type="number" is="iron-input"
        bind-value="{{number}}">
    </div>

  </template>
</dom-module>
<script>
  Polymer({

    is: 'input-phone',

    properties: {
      number: {
        type: Number,
        observer: '_on_change_number'
      },
      prefix: {
        type: Number,
        observer: '_on_change_prefix'
      },
      phone: {
        type: String,
        notify: true
      },
      label: {
        type: String,
        value: ''
      }
    },

    attached: function () {
      if (this.phone) {
        if (this.phone.length > 0 && this.phone.indexOf('-') >= 0)Â {
          var prefix_num = this.phone.split('-');
          this.prefix = prefix_num[0];
          this.number = prefix_num[1];
          return;
        }
      }
    },

    _on_change_number: function () {
      this.update_phone();
    },

    _on_change_prefix: function () {
      this.update_phone();
    },

    update_phone: function () {
      if (this.prefix.length > 0 && this.number.length > 0) {
        this.phone = this.prefix + '-' + this.number;
        return;
      }
      this.phone = '';
    }

  });
</script>