<link rel="import" href="/components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/components/layout-grid/layout-grid.html">
<dom-module id="image-view">
  <template>
  <style>
    :host{
      display: block
    }
    .image {
      width: 100%;
      height: 300px;
      background-position: center center;
      background-repeat: no-repeat;
    }
    .image:hover {
      /*background-size: 70% 70%;*/
    }
  </style>

  <div class="image" style$="{{style}}"></div>


  </template>
</dom-module>
<script>
  Polymer({

    is: 'image-view',

    properties: {
      image: {
        type: Object,
        value: function () { return {}; }
      }
    },

    attached: function (event) {
      var size = this.get_size();
      var image_name = this.create_image_name(size);
      var host = 'http://localhost:3000';
      var url = host + '/storage/' + this.image.container + '/' + this.image.id + '/' + image_name + '.jpg';
      var rules = [
        'background-image: url("' + url + '")',
        'background-size: ' + size
      ];
      this.style = rules.join(';');
    },

    get_size: function () {
      if (this.image.thumbs.indexOf(400) >= 0 )
        return this.image.thumbs[this.image.thumbs.indexOf(400)];
      if (this.image.thumbs.indexOf(120) >= 0 )
        return this.image.thumbs[this.image.thumbs.indexOf(120)];
      if (this.image.thumbs.indexOf(80) >= 0 )
        return this.image.thumbs[this.image.thumbs.indexOf(80)];
      if (this.image.thumbs.indexOf(50) >= 0 )
        return this.image.thumbs[this.image.thumbs.indexOf(50)];
      return -1;
    },

    create_image_name: function (size) {
      var prefix = 'thumb-';
      if (size <= 0) {
        return 'original';
      }
      return prefix + size;
    },

  });
</script>