<link rel="import" href="form-wishlist-description.html">
<dom-module id="part-wishlist-item">
  <template>
    <style>
      :host {
        display: block;
      }
      .whislist_descriptionÂ {
        display: none;
      }
      .whislist_description[visible] {
        display: block;
      }
    </style>

    <div class="title">
      <span>{{favourite.product.title}}</span>
      <template is="dom-if" if="{{favourite.product_variant}}">
        ( <span>{{favourite.product_variant.name}}</span> )
      </template>
    </div>

    <div>{{favourite.product.description}}</div>
    <div>{{price}}</div>
    <div>{{favourite.description}}</div>

    <a href="{{favourite.url}}">view</a>
    <button on-click="on_click_description">add description</button>
    <button on-click="on_click_remove">remove</button>

    <form-wishlist-description class="whislist_description" visible$="{{visible}}"
      favourite="{{favourite}}" on-add-description="on_add_description">
    </form-wishlist-description>

  </template>
</dom-module>
<script>
  Polymer({

    is: 'part-wishlist-item',

    properties: {
      favourite: {
        type: Object,
        value: function () { return {}; }
      },
      visible: {
        type: Boolean,
        value: false
      }
    },

    attached: function () {
      if (this.favourite.product_variant) {
        this.price = this.favourite.product_variant.price;
        return
      }
      this.price = this.favourite.product.price;
    },

    on_click_remove: function (event) {
      event.stopPropagation();
      this.fire('try-remove-favourite', this.favourite);
    },

    on_click_description: function (event) {
      event.stopPropagation();
      this.set('visible', true);
    },

    on_add_description: function (event) {
      //bubble up - for add description
      this.set('visible', false);
    }

  });
</script>